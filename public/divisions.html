<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oak Dragon Covenant - Division Command Center</title>
    <link rel="stylesheet" href="/css/divisionStyles.css">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Oak Dragon Covenant Division Command Center - Manage your industry verticals and legal entities">
</head>
<body>
    <div id="divisionCommandCenter" class="division-command-center">
        <!-- Content will be dynamically generated by JavaScript -->
        <div class="loading-screen">
            <div class="loading-glyph">ðŸ§­</div>
            <h2>Initializing Command Center...</h2>
            <p>Loading division registry and entity database</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/divisionCommandCenter.js"></script>
    <script>
        // Initialize the Division Command Center
        class CovenantDivisionRegistry {
            constructor() {
                this.divisions = new Map();
                this.entities = new Map();
                this.initializeDivisions();
                this.loadSampleData();
            }

            initializeDivisions() {
                const divisionConfigs = [
                    {
                        id: 'real-estate',
                        name: 'Real Estate',
                        glyph: 'ðŸ¡',
                        color: '#8B4513',
                        description: 'Sacred land acquisition, asset tokenization, and property sanctification',
                        capabilities: ['Asset Registry', 'Deed Rituals', 'Zoning Overlays', 'Sacred Land Tokens'],
                        defaultTabs: ['Land Deed Vault', 'Zoning & Compliance', 'Asset Tokenization', 'Property Timeline']
                    },
                    {
                        id: 'crypto-trading',
                        name: 'Crypto Trading',
                        glyph: 'ðŸª™',
                        color: '#FFD700',
                        description: 'Multi-exchange automation, bot orchestration, and digital asset mastery',
                        capabilities: ['Exchange Mapping', 'Bot Deployments', 'Fee Optimization', 'Trading Rituals'],
                        defaultTabs: ['Exchange Registry', 'Bot Command Center', 'Fee Analysis', 'Trading History']
                    },
                    {
                        id: 'stock-investing',
                        name: 'Stock Investing',
                        glyph: 'ðŸ“ˆ',
                        color: '#006400',
                        description: 'Traditional market wisdom, portfolio sanctification, and equity governance',
                        capabilities: ['Portfolio Management', 'Market Analysis', 'Risk Assessment', 'Dividend Tracking'],
                        defaultTabs: ['Portfolio Overview', 'Market Positions', 'Performance Analytics', 'Investment Timeline']
                    },
                    {
                        id: 'e-commerce',
                        name: 'E-Commerce',
                        glyph: 'ðŸ›’',
                        color: '#FF6347',
                        description: 'Digital marketplace mastery, brand sanctums, and commerce rituals',
                        capabilities: ['Store Management', 'Inventory Tracking', 'Order Processing', 'Customer Analytics'],
                        defaultTabs: ['Store Dashboard', 'Product Catalog', 'Order Management', 'Analytics Hub']
                    },
                    {
                        id: 'education',
                        name: 'Education & Coaching',
                        glyph: 'ðŸŽ“',
                        color: '#4169E1',
                        description: 'Knowledge transmission, mentor lineages, and wisdom cultivation',
                        capabilities: ['Curriculum Design', 'Student Tracking', 'Certification', 'Mentor Network'],
                        defaultTabs: ['Course Library', 'Student Portal', 'Certification Vault', 'Mentor Registry']
                    },
                    {
                        id: 'self-banking',
                        name: 'Self Banking',
                        glyph: 'ðŸ¦',
                        color: '#2F4F4F',
                        description: 'Personal finance sovereignty, cashflow rituals, and monetary sanctification',
                        capabilities: ['Account Management', 'Transaction Tracking', 'Budget Planning', 'Investment Allocation'],
                        defaultTabs: ['Account Overview', 'Transaction History', 'Budget Dashboard', 'Investment Tracker']
                    },
                    {
                        id: 'private-insurance',
                        name: 'Private Insurance',
                        glyph: 'ðŸ›¡ï¸',
                        color: '#8A2BE2',
                        description: 'Risk mitigation, coverage sanctification, and protection protocols',
                        capabilities: ['Policy Management', 'Claims Processing', 'Risk Assessment', 'Coverage Analysis'],
                        defaultTabs: ['Policy Vault', 'Claims Center', 'Risk Dashboard', 'Coverage Map']
                    },
                    {
                        id: 'business-acquisition',
                        name: 'Business Acquisition',
                        glyph: 'ðŸ¢',
                        color: '#DC143C',
                        description: 'Strategic acquisitions, due diligence rituals, and integration mastery',
                        capabilities: ['Target Analysis', 'Due Diligence', 'Deal Management', 'Integration Planning'],
                        defaultTabs: ['Target Registry', 'Deal Pipeline', 'Due Diligence', 'Integration Hub']
                    }
                ];

                divisionConfigs.forEach(config => {
                    this.divisions.set(config.id, {
                        ...config,
                        entities: [],
                        createdAt: new Date().toISOString(),
                        lastUpdated: new Date().toISOString()
                    });
                });
            }

            loadSampleData() {
                // Add sample entities for demonstration
                this.createEntity('real-estate', {
                    name: 'Dragon Properties LLC',
                    jurisdiction: 'Delaware',
                    entityType: 'LLC',
                    ritualTier: 'Core',
                    assignedAgents: ['PropertyAgent', 'ValuationAgent']
                });

                this.createEntity('crypto-trading', {
                    name: 'Covenant Digital Assets Corp',
                    jurisdiction: 'Wyoming',
                    entityType: 'Corporation',
                    ritualTier: 'Core',
                    assignedAgents: ['TradingBot', 'AnalyticsAgent']
                });

                this.createEntity('self-banking', {
                    name: 'Oak Financial Trust',
                    jurisdiction: 'Nevada',
                    entityType: 'Trust',
                    ritualTier: 'Legacy',
                    assignedAgents: ['BankingAgent', 'ComplianceAgent']
                });
            }

            getDivision(divisionId) {
                return this.divisions.get(divisionId);
            }

            getAllDivisions() {
                return Array.from(this.divisions.values());
            }

            createEntity(divisionId, entityConfig) {
                const division = this.divisions.get(divisionId);
                if (!division) {
                    throw new Error(`Division ${divisionId} not found`);
                }

                const entity = {
                    id: entityConfig.id || `${divisionId}-entity-${Date.now()}`,
                    name: entityConfig.name,
                    jurisdiction: entityConfig.jurisdiction,
                    entityType: entityConfig.entityType,
                    status: entityConfig.status || 'Active',
                    ritualTier: entityConfig.ritualTier || 'Core',
                    assignedAgents: entityConfig.assignedAgents || [],
                    tabs: [...division.defaultTabs, ...(entityConfig.customTabs || [])],
                    activities: [],
                    createdAt: new Date().toISOString(),
                    lastUpdated: new Date().toISOString(),
                    divisionId: divisionId
                };

                division.entities.push(entity.id);
                this.entities.set(entity.id, entity);
                division.lastUpdated = new Date().toISOString();

                return entity;
            }

            getEntitiesByDivision(divisionId) {
                const division = this.divisions.get(divisionId);
                if (!division) return [];

                return division.entities.map(entityId => this.entities.get(entityId)).filter(Boolean);
            }

            getEntity(entityId) {
                return this.entities.get(entityId);
            }

            addActivityToEntity(entityId, activity) {
                const entity = this.entities.get(entityId);
                if (!entity) {
                    throw new Error(`Entity ${entityId} not found`);
                }

                const activityEntry = {
                    id: `activity-${Date.now()}`,
                    timestamp: new Date().toISOString(),
                    type: activity.type,
                    description: activity.description,
                    data: activity.data || {},
                    agentId: activity.agentId,
                    ritualContext: activity.ritualContext
                };

                entity.activities.unshift(activityEntry);
                entity.lastUpdated = new Date().toISOString();

                if (entity.activities.length > 100) {
                    entity.activities = entity.activities.slice(0, 100);
                }

                return activityEntry;
            }

            searchEntities(query, filters = {}) {
                const allEntities = Array.from(this.entities.values());
                
                let filteredEntities = allEntities;

                if (query) {
                    filteredEntities = filteredEntities.filter(entity => 
                        entity.name.toLowerCase().includes(query.toLowerCase()) ||
                        entity.jurisdiction.toLowerCase().includes(query.toLowerCase()) ||
                        entity.entityType.toLowerCase().includes(query.toLowerCase())
                    );
                }

                if (filters.division) {
                    filteredEntities = filteredEntities.filter(entity => entity.divisionId === filters.division);
                }

                if (filters.status) {
                    filteredEntities = filteredEntities.filter(entity => entity.status === filters.status);
                }

                if (filters.ritualTier) {
                    filteredEntities = filteredEntities.filter(entity => entity.ritualTier === filters.ritualTier);
                }

                return filteredEntities;
            }

            getSystemStats() {
                const stats = {
                    totalDivisions: this.divisions.size,
                    totalEntities: this.entities.size,
                    entitiesByDivision: {},
                    entitiesByStatus: {},
                    entitiesByTier: {},
                    recentActivities: []
                };

                this.divisions.forEach((division, divisionId) => {
                    stats.entitiesByDivision[divisionId] = division.entities.length;
                });

                this.entities.forEach(entity => {
                    stats.entitiesByStatus[entity.status] = (stats.entitiesByStatus[entity.status] || 0) + 1;
                    stats.entitiesByTier[entity.ritualTier] = (stats.entitiesByTier[entity.ritualTier] || 0) + 1;
                });

                return stats;
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            const registry = new CovenantDivisionRegistry();
            const commandCenter = new DivisionCommandCenter('divisionCommandCenter', registry);
            
            // Make it globally accessible for debugging
            window.covenantRegistry = registry;
            window.covenantCommand = commandCenter;
            
            // Store reference in the container for event handlers
            document.getElementById('divisionCommandCenter').divisionCenter = commandCenter;
            
            console.log('ðŸ§­ Oak Dragon Covenant Division Command Center Initialized');
            console.log(`ðŸ“Š Loaded ${registry.getAllDivisions().length} divisions and ${registry.entities.size} entities`);
        });
    </script>

    <style>
        .loading-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }

        .loading-glyph {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: pulse 2s ease-in-out infinite;
        }

        .loading-screen h2 {
            color: var(--covenant-gold);
            margin-bottom: 10px;
        }

        .loading-screen p {
            color: #cccccc;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }
    </style>
</body>
</html>
